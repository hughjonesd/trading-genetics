---
title: "Genes are not nature: effects of socio-economic status on genetics in UK Biobank"
author: David Hugh-Jones, Oana Borcan & Abdel Abdellaoui
date: "`r Sys.Date()`"
output: 
  bookdown::pdf_document2:
    toc: false
    latex_engine: xelatex
    number_sections: false
editor_options: 
  chunk_output_type: console
bibliography: bibliography.bib
spacing: double
header-includes:
  - \usepackage{subfig}
  - \usepackage{amsmath}
  - \usepackage{amsthm}
  - \usepackage{setspace}
  - \usepackage{placeins}
  - \newtheorem{prop}{\protect\propositionname}
  - \providecommand{\propositionname}{Proposition}
---

```{r setup, include = FALSE}
library(Formula)
library(car)
library(drake)
library(dplyr)
library(magrittr)
library(AER)
library(ggplot2)
library(Hmisc)
library(huxtable)
library(broom)
library(fixest)
library(santoku)
library(purrr)

knitr::opts_chunk$set(echo = FALSE)

drake::loadd(mf_pairs)
drake::loadd(mf_pairs_twice)
drake::loadd(famhist)
drake::loadd(resid_scores)

famhist %<>% left_join(resid_scores, by = "f.eid")
rm(resid_scores)

famhist$EA3 <- famhist$EA3_excl_23andMe_UK_resid

theme_set(theme_minimal())

```

\normalem

# Introduction

It is well known that both an individual's genetics, and his or her
environment, influence a wide range of life outcomes, including physical
and mental health, income and social status, spouse choice, family
formation and personality. Both popular and scientific discourse often
parse these two forces as "nature" and "nurture" [e.g.
@plomin1994genetics; @chakravarti2003nature].[^1] The implicit logic is
that a person's environment is the product of his or her society; genes,
on the other hand, are part of his or her nature.

[^1]: This holds even among scientists who wish to go beyond the
    nature-nurture dichotomy, e.g. [@rutter2002nature].

At the level of the individual, this idea expresses the fact that our
genetic endowment is fixed at birth and cannot be influenced by our
social environment. While genes may be expressed differently over the
life cycle, and importantly may interact with the environment to cause
different outcomes, the genes themselves do not change. This feature
allows them to be used as an "unmoved mover" to untangle social
causality, in techniques like Mendelian randomization.

But as soon as we move beyond individual level, the idea that human
genetics are natural becomes highly misleading. Humans inherit their
genes from their parents, along with other forms of inheritance such as
economic and cultural capital. Human parents, in turn, meet, form spouse
pairs, bear children, and raise them, within social institutions
including marriage markets and family structures. Therefore, a person's
genetic inheritance is a social and historical fact about them, and not
a fact of nature, any more than their inherited wealth or social status
is natural. As [@marx1844economic] wrote, "History is the true natural
history of man".

Indeed, genetic assets and other kinds may be substitutable in marriage
markets. [@marx1844economic] also wrote "I am ugly, but I can buy the
most beautiful woman.... the effect of ugliness, its repelling power, is
destroyed by money". On the opposite side of the political spectrum,
[@herrnstein1995bell] warned of "a merging of the cognitive elite with
the affluent". These quotations suggest that social advantages, such as
wealth, income, caste or class, may have genetic consequences. If there
is assortative mating between socially and genetically advantaged
people, then socio-economic status may be reflected in the DNA of
subsequent generations.

Figures \@ref(fig:pic-basic-corr-uni) and
\@ref(fig:pic-basic-corr-income) illustrate this idea using data for
spouse pairs from UK Biobank, a sample of about 500,000 UK respondents
born between 1935 and 1970. The X axis shows a measure of one partner's
socio-economic status: university attendance (Figure
\@ref(fig:pic-basic-corr-uni) or income (Figure
\@ref(fig:pic-basic-corr-income)). The Y axis plots the other partner's
mean polygenic score for educational attainment (PSEA). This measure is
derived solely from the partner's genetic data, and is a predictor of
the number of years spent in education, as well as university attendance
and IQ.[^2] Both males and females who went to university had spouses
with higher PSEA. So did males and females with higher income. Since DNA
is inherited, these people's children will also have higher PSEA.

[^2]: To minimize concerns about genetic stratification, i.e.
    correlations between genetics and non-genetic inherited
    characteristics such as culture, PSEA is residualized on the first
    100 principal components of UK Biobank array data.

These figures do not prove that genetic encoding of socio-economic
status is taking place. Since an individual's own PSEA correlates with
both their educational attainment, and their income, both figures could
be a result of partner selection on a purely genetic basis. In this
paper, we test the theory more rigorously, using environmental shocks to
socio-economic status that are unlikely to be correlated with own
genetics. First, we develop a simple model of assortative mating to show
how parents' social status predicts children's genetics, and how this
varies with social structure.

```{r pic-basic-corr-uni, fig.subcap = c("Female PSEA by male educational attainment", "Male PSEA by female educational attainment"), fig.cap = "Social and genetic advantage among spouse pairs in UK Biobank", fig.width = 3, fig.height = 3}

pic_ss <- stat_summary(fun.data = mean_cl_normal, na.rm = TRUE)
pic_cc <- coord_cartesian(ylim = c(-0.05, 0.2))

mf_pairs %>% 
      filter(! is.na(university.m)) %>% 
      ggplot(aes(university.m, EA3.f)) + 
        pic_ss + pic_cc +
        labs(x = "Male university attendance", y = "Female PSEA")

mf_pairs %>% 
      filter(! is.na(university.f)) %>% 
      ggplot(aes(university.f, EA3.m)) + 
        pic_ss + pic_cc +
        labs(x = "Female university attendance", y = "Male PSEA")
        
```

```{r pic-basic-corr-income, fig.subcap = c("Female EA3 by male income", "Male EA3 by female income"), fig.cap = "Social and genetic advantage among spouse pairs in UK Biobank", fig.width = 3, fig.height = 3}

pic_ss <- stat_summary(fun.data = mean_cl_normal, na.rm = TRUE)
pic_cc <- coord_cartesian(ylim = c(-0.15, 0.25))

mf_pairs %>% 
      filter(! is.na(income_cat.m)) %>% 
      ggplot(aes(income_cat.m, EA3.f)) + 
        pic_ss + pic_cc + 
        labs(x = "Male income category", y = "Female PSEA")

mf_pairs %>% 
      filter(! is.na(income_cat.f)) %>% 
      ggplot(aes(income_cat.f, EA3.m)) + 
        pic_ss + pic_cc +
        labs(x = "Female income category", y = "Male PSEA")
        
```

# Model

There is a large population, whose members have a single genetic trait
$g_{i}$ and a single social trait $s_{i}$, drawn from distributions $G$
and $S$. The genetic trait could be, for instance, a polygenic score,
which summarizes the effects of many alleles (genetic variants) at
different loci. The social trait is a measure of social status. Broadly
conceived, this means any trait that an individual possesses in virtue
of his or her position in society, rather than as a natural fact. Caste
and class are kinds of social status; so are wealth, income, education
and employment.

$G$ and $S$ are continuously distributed. Without loss of generality,
$EG = ES = 0$ and $Var(G) = Var(S) = 1$.[^3] People pair according to an
attractiveness function

[^3]: Continuous distribution is not strictly required. All that is
    needed is for a set of pairs of positive measure to have different
    values of $G$ and $S$, along a set of attractiveness curves of
    positive measure.

$$
A(g_{i},s_{i}) = f((1-k)g_{i},ks_{i})
$$

where $f$ is smooth and strictly increasing in both its arguments, and
$0 \le k \le 1$.

The key parameter is $k$. This describes the working of the society's
marriage market. If $k = 0$, only genetics $G$ are relevant in marriage
markets, and social status $S$ has no effect. That is, the marriage
market is highly egalitarian. Conversely, if $k = 1$, only social status
matters, to the complete exclusion of genetics. This is the equivalent
of a marriage market driven only by "caste" or "class". Realistic
societies are between these extremes.

Figure \@ref(fig:pic-intuition) shows the intuition behind our theory.
The top row shows a *caste marriage market* with $k = 1$. A typical pair
is shown: children have intermediate values of $G$ and $S$ between their
two parents (hollow circle). In this society pairs match only by social
status; genetics plays no role. As a result, while the variance of $G$
shrinks within each status group, genetics remain uncorrelated with
social status in the children's population distribution, shown on the
right. The next row shows a purely *egalitarian marriage market* with
$k = 0$. Parents match only by genetics and ignore social status. Again,
as a result there is no correlation between genetics and social status
in the children's generation. The bottom row shows a (more realistic)
intermediate society, with an intermediate value of $k$. Because both
genetics and social status contribute to attractiveness, matched spouses
typically trade them off against each other. As a result, the
distribution is squeezed along the gradient of $k$, and $G$ and $S$ are
correlated in the children's generation. We next prove this formally.

If $k = 0$, "indifference curves" of attractiveness are vertical lines
in $(G, S)$ space. If $k = 1$, they are horizontal lines. If
$k \in (0,1)$ they are downward sloping curves.

Write $p(i)$ for $i$'s partner. Pairs always have the same
attractiveness.

$$
A(g_{i},s_{i}) = A(g_{p(i)},s_{p(i)}).
$$

Each pair has two children. We assume that both children $c(d)$ of
parents $d$, $m$ have

```{=tex}
\begin{align}
g_{c(d)} & =\frac{g_{d}+g_{m}}{2};\label{eq:children-average}\\
s_{c(d)} & =\frac{s_{d}+s_{m}}{2}.\nonumber 
\end{align}
```
This is a strong assumption; we relax it later. For real world examples
approximated by it, $S$ could be wealth which is equally divided between
the children; $G$ could be a highly polygenic trait with many small
effects. Write $G_{p}, S_{p}$ to denote the population variables in the
parents' generation; $G_{c}, S_{c}$ for the children's generation.

```{=tex}
\begin{prop}
\label{prop:prop1}
(i) $Cov(G_{c}, S_{c}) \ge Cov(G_{p},S_{p})$, with strict inequality
if and only if $0 < k < 1$. 

(ii) If $corr(G_{p}, S_{p}) \ge 0$, then $corr(G_{c},S_{c}) \ge corr(G_{p},S_{p})$,
with strict inequality if and only if $0 < k < 1$ \uline{or} 
$corr(G_{p}, S_{p}) > 0$.
\end{prop}
```
```{=tex}
\begin{proof}

Within each pair $i,p(i)$ write $d$ for the person with $s_{d}>s_{p(d)}$
and $m$ for $p(d)$. (Think of these as "dukes" and "milkmaids",
or if you prefer "duchesses" and "tennis instructors".) If
$k < 1$, then $g_{d} < g_{m}$. (If $k = 0$, then define $d$ as the person
with $g_{d} < g_{p(d)}$.)

We integrate over the "dukes" to calculate the covariance in the
parents' generation:
\[
cov(G_{p},S_{p})=\int\frac{1}{2}(g_{d}s_{d}+g_{p(d)}s_{p(d)})\,\mathrm{d}d.
\]

For the children, the equivalent expression is
\[
cov(G_{c},S_{c})=\int g_{c(d)}s_{c(d)}\mathrm{d}d,
\]

observing that $EG_{c} = ES_{c}=0$ from (\ref{eq:children-average}).

Take an arbitrary pair $d,m$. Write

\begin{align*}
g_{d}s_{d} & =(g_{c}-\Delta g)(s_{c}+\Delta s);\\
g_{m}s_{m} & =(g_{c}+\text{\ensuremath{\Delta g)(s_{c}-\Delta s)}}
\end{align*}

where 

\begin{align*}
\text{\ensuremath{\Delta g=\frac{g_{m}-g_{d}}{2}\ge0}}, & \textrm{strictly so if and only if }k>0;\\
\Delta s=\frac{s_{d}-s_{m}}{2}\ge0 & \textrm{strictly so if and only if }k<1.
\end{align*}

Taking the average of the parents gives

\[
\frac{1}{2}(g_{d}s_{d}+g_{m}s_{m})= g _{c}s_{c}-\Delta g\Delta s.
\]

This is less than $g_{c}s_{c}$ if $0 < k < 1$, and equal to it if $k = 0$
or $k = 1$. Plugging this into the integral shows that 

\[
cov(G_{p},S_{p})\le cov(G_{c},S_{c})
\]

again with strict inequality if and only if $0 < k < 1$. This proves the first
part. A similar argument, showing $var(G_c) \le var(G_p)$ and $var(S_c) \le
var(S_p)$, proves the second part (see the appendix). Figure
\ref{fig:Correlation-counterexample} in the appendix shows that the condition in
the second part cannot be relaxed further.

\end{proof}
```
```{r pic-intuition, fig.subcap = c("Caste society ($k = 1$): parents", "Caste society: children", "Egalitarian society ($k = 0$): parents", "Egalitarian society: children", "Intermediate society ($0 < k < 1$): parents", "Intermediate society: children"), fig.cap = "Theory: shaded area is the population distribution. Dotted lines are attractiveness isoquants. Solid dots are example parents, transparent dots are example children. The right hand side shows the children's generation.", fig.ncol = 2, fig.width = 2.75, fig.height = 2.4, fig.align='center'}


setup_plot <- function () {
  par(mar = rep(2.1, 4))
  plot.new()
  plot.window(c(-1.2, 1.2), c(-1.2, 1.2))
  arrows(x0 = -1.1, x1 = 1.1, y0 = -1.1, length = .1)
  arrows(y0 = -1.1, y1 = 1.1, x0 = -1.1, length = .1)
  text(-1.1, 1.2, "S", cex = 0.7)
  text(1.2, -1.1, "G", cex = 0.7)
}

draw_dist <- function (w) {
  if (! is.matrix(w)) w <- matrix(c(w, 0, 0, 1), nrow = 2)
  mygrey <- grey(.85, .03)
  for (rad in seq(0.2, 1, 0.1)) {
    v <- car::ellipse(c(0, 0), shape = w, radius = rad, add = TRUE, center.pch = NULL,
               fill = TRUE, col = mygrey, lwd = 0, segments = 241)
  }
  
  v
}

draw_dist_with_a <- function (width, shift, curved_lines = FALSE) {
  setup_plot()  
  v <- draw_dist(width)
  nr_v <- nrow(v)
  
  rotation <- (-shift + seq_len(nr_v)) %% nr_v
  rotation[rotation == 0] <- nr_v
  
  v <- v[rotation, ]
  v_rev <- v[nr_v:1, ]
  
  ivls <- quantile(seq_len(nr_v/2), seq(0.2, 0.8, .2), type = 1)
  
  start_x <- v[ivls, 1]
  end_x   <- v_rev[ivls, 1]
  start_y <- v[ivls, 2]
  end_y <- v_rev[ivls, 2]
  
  if (curved_lines) {
    for (l in seq_along(start_x)) {
      sx <- start_x[l] + c(0, 0.15, 0.85, 1) * (end_x[l] - start_x[l])
      sy <- start_y[l] + c(0, 0.05, 0.65, 1) * (end_y[l] - start_y[l])
      spl <- stats::spline(sx, sy)
      if (l ==2) mid_spl <- spl
      lines(spl, lty = 2)
    }
    
    start_x <- mid_spl$x[2]
    start_y <- mid_spl$y[2]
    end_x <- mid_spl$x[8]
    end_y <- mid_spl$y[8]
    inset <- 0
  } else {
    segments(x0 = start_x, x1 = end_x, y0 = start_y, y1 = end_y, lty = 2)  
    
    ivls <- ivls[2:3]
  
    start_x <- mean(v[ivls, 1])
    end_x   <- mean(v_rev[ivls, 1])
    start_y <- mean(v[ivls, 2])
    end_y   <- mean(v_rev[ivls, 2])
    inset <- 0.15
  }
  
  
  along <- function (tt) list(
    x = start_x + tt * (end_x - start_x),
    y = start_y + tt * (end_y - start_y)
  )
  
  end_inset <- 0.15
  starts <- along(c(inset, 1 - inset))
  ends   <- along(c(0.5 - end_inset, 0.5 + end_inset))
  pts <- along(c(inset/2, .5, 1 - inset/2))
  arrows(x0 = starts$x, x1 = ends$x, y0 = starts$y, y1 = ends$y,
         length = 0.05)
  
  points(x = pts$x, y = pts$y, pch = c(19, 21, 19), cex = 0.8)
}

draw_dist_with_a(.8, 0)
setup_plot()
invisible(draw_dist(matrix(c(.4, 0, 0, 1), nrow = 2)))

draw_dist_with_a(.8, 60)
setup_plot()
invisible(draw_dist(matrix(c(.8, 0, 0, .4), nrow = 2)))

draw_dist_with_a(.8, -30, curved_lines = TRUE)
setup_plot()
invisible(draw_dist(matrix(c(1, .4, .4, .8), nrow = 2)))



```

We view $k = 0$ and $k = 1$ as theoretical "ideal types". Proposition
\ref{prop:prop1} therefore shows that in almost any realistic society,
social status will become correlated with genetic traits which are
considered attractive in the marriage markets.

We now relax the condition that children are exactly at the mean of
their parents' values for $G$ and $S$. Let

```{=tex}
\begin{align*}
g_{c(i)} & = \bar{g}_{i}+\varepsilon_{i}^{G} \\
s_{c(i)} & = \bar{s}_{i}+\varepsilon_{i}^{S}
\end{align*}
```
where

$$
\bar{g}_{i} = \frac{g_{i} + g_{p(i)}}{2}; \bar{s}_{i} = \frac{s_{i} + s_{p(i)}}{2};
$$

$\varepsilon^{G}$ has mean 0 and variance $\sigma_{G}^{2}$; and
$\varepsilon^{S}$ has mean 0 and variance $\sigma_{S}^{2}$.

```{=tex}
\begin{prop}
\label{prop:robustness}

\begin{enumerate}

\item If $\sigma_{G}^{2}$ and $\sigma_{S}^{2}$ are small enough and $corr(G_{p},S_{p}) \ge 0$,
then $corr(G_{c},S_{c}) > corr(G_{p},S_{p})$ for $k \in (0,1)$.

\item If $\varepsilon^{G}$ and $\varepsilon^{S}$ are uncorrelated with
each other and with $\bar{G}$ and $\bar{S}$; and if $G_{p}$ and
$S_{p}$ are uncorrelated, then $corr(G_{c},S_{c}) \ge 0$, with strict
inequality if and only if $0<k<1$.

\end{enumerate}

\end{prop}
```
The conditions in Proposition \ref{prop:robustness} are quite plausible.
For $G$, they require that either variance in siblings' scores on some
summary statistic is not too large, or that it is uncorrelated with the
parents' scores. Both of these hold for most polygenic scores, which are
additive sums of many small effects of alleles derived randomly from one
or other parent. For $S$, the conditions would hold, for example, if $S$
measures wealth, which is inherited not too unequally between siblings;
or if wealth is inherited unequally but not in a way that correlates
with $S$ or $G$.

It is worth considering what kind of social arrangements would *violate*
these conditions. For example, suppose that parents' combined wealth is
inherited by the child with the lowest value of $g_{c(i)}$. This creates
a negative correlation between $s_{c(i)}$ and $g_{c(i)}$.

In the model, intermediate values of $k$ drive increased covariance
between genetics and social status. That naturally raises the question
whether the change in covariance and/or correlation is increasing in $k$
towards some maximum value in $(0,1)$, then decreasing, i.e., whether it
is quasiconcave in $k$. In general the answer is no, even on the
assumption that

$$
A(g_{i},s_{i}) = (1-k)g_{i} + ks_{i}
$$

i.e. that indifference curves are straight lines in $(G, S)$ space.
However, quasiconcavity in $k$ does hold when indifference curves are
straight and $(G, S)$ are jointly normally distributed. We conjecture
that it also holds whenever the distribution $(G, S)$ is log-concave or
even quasiconcave.

## Discussion

-   TODO: discuss relationship with linkage disequilibrium between
    genes, caused by assortative mating. Hunt for any pre-existing
    theory in the genetics literature.

The "marriage market" here is a reduced form mechanism, encompassing
everything that makes a difference to partner choice. For example, if
earned income affects attractiveness in the marriage market, then
society's level of meritocracy in the labour market will correlate with
the value of $k$: a more meritocratic labour market will allow people
with low social status but high human capital (partly genetically
determined) to earn more, and therefore to match with more attractive
partners.

The contents of both $S$, social status, and $G$ -- what counts as "good
genes" in the marriage market -- are likely to vary across societies.
$S$ could encompass variables like social class or caste; ethnic
identity in "ranked" ethnic systems; or in modern societies,
*socio-economic status* (SES), i.e. variables affecting a person's
position in the labour market. Regarding $G$, standards of physical
attractiveness, and other characteristics which make someone a "good
match", vary both across societies and within a society over time.

The model predicts variation in the strength of genetic lock-in. In
particular, in "caste societies" where there is complete endogamy within
social status groups, there is no scope for genetic lock-in, because
marriage partners do not trade off genetics for social status. The model
also assumes that social status is inherited randomly from one parent,
in the same way a genetic allele is inherited. This assumption can be
weakened. For example, if social status is inherited deterministically
from the father, then the results remain unchanged (for each pair of
parents, just assume that one randomly chosen parent is the father).

It is well known that genetics, e.g. PSEA, correlate with SES in modern
societies [e.g. @Krapohl_2015]. A standard explanation for this is that
in meritocratic societies, successful people may transmit relevant genes
to their offspring, along with their status [@belsky2018genetic]. Our
mechanism is different from this, though not mutually exclusive. In the
standard model, certain genetic variants *cause* higher SES, and are
then transmitted along with it. Indeed, genetic variations which lead to
high status will become associated with it, even in the absence of
assortative mating. Conversely, this logic would not apply in
non-meritocratic societies, where social status is ascribed rather than
earned. Indeed, [@Rimfeld_2018] show that genetic influences on
education and occupation were lower in (non-meritocratic) Soviet Estonia
than in the more meritocratic post-Soviet period.

By contrast, our mechanism applies to genetic variants that are
*associated* with higher status during the spouse matching process. They
do not need to exert any causal effect on an individual's own social
status. Whereas the mechanism above requires meritocracy, but not
assortative mating, our mechanism requires assortative mating, but not
meritocracy. Our mechanism therefore potentially applies to a much wider
range of societies, including societies where social status is wholly
ascribed or inherited.

In modern societies, both assortative mating and meritocracy are likely
to be at play. Genetic variants that cause (e.g.) higher income and
wealth will be inherited along with components of social status such as
inherited wealth. At the same time, higher social status and "good
genes" will assort in the marriage market, even if that higher social
status is caused by purely environmental variation. Our empirical
analysis shows this latter process at work.

# Related literature

-   Idea that assortative mating might increase inequality is widely
    known, but it is usually put in terms of assortation by IQ or by
    genetics alone.

-   Could the result be thought of as a kind of population
    stratification?

-   [@halsey1958genetics] showed in a two-class model that social
    mobility combined with assortative mating might increase the
    association between genetics and social class. But NB, the
    assortation is completely random within classes. So effectively this
    is a society with $k=1$, but some social mobility.

-   

-   [@belsky2018genetic] offer three reasons for the association between
    education-linked genetics and SES, but do not consider our
    mechanism.

# Data and methods

To test the theory, we use data from the UK Biobank, a study of about
500,000 individuals born between 1935 and 1970. The Biobank contains
information on respondents' genetics, derived from DNA microarrays,
along with questionnaire data on health and social outcomes. Using
respondents' exact home location, we categorize some respondents as
spouse pairs.

Our key dependent variable is spouse's *Polygenic Score for Educational
Attainment* (PSEA). A polygenic score is a DNA-derived summary measure
of genetic risk or propensity for a particular outcome, created from
summing small effects of many common genetic variants, known as Single
Nucleotide Polymorphisms (SNPs). We use per-SNP summary statistics from
[@lee2018gene], recalculated excluding UK Biobank participants, to
calculate PSEA. We focus on PSEA, rather than other polygenic scores,
because educational attainment plays a key role in human mate search.
People are attracted to educated potential partners
[@buss1986preferences; @belot2013dating]. Spouse pairs often have
similar levels of educational attainment, as well as similar PSEA
[@vandenberg1972assortative; @schwartz2005trends; @greenwood2014marry;
@hugh2016assortative].

As we said above, simple correlations between one partner's social
status and the other partner's genetics do not prove that genetic
encoding is taking place. Since social status correlates with one's own
genetics, the correlation could be driven purely by assortative mating
for genetics [@hugh2016assortative]. To demonstrate genetic lock-in, we
need a source of social status which is exogenous to genetics. Also, the
link between social status and spouse genetics is likely to be noisy,
for three reasons: first, measures of genetic variation such as
polygenic scores contain a large amount of error; second, causal
mechanisms behind variation in social status are likely to be noisy;
third, to paraphrase [@shakespeare1595midsummer], the spouse matching
process is notoriously unpredictable. So, we need a large N to give us
sufficient power. This rules out time-limited shocks such as e.g.
changes to the school leaving age.

One possibility is *birth order*. It is known that earlier-born children
receive more parental care and have better life outcomes
[@booth2009birth; @black2011older]. On the other hand, all full siblings
have the same *ex ante* expected genetic endowment from their parents,
irrespective of their birth order. For example, siblings' expected
polygenic score is equal to the mean of their parents' polygenic scores.
[^4] We can therefore use birth order as a "shock" to social status. We
do not claim that birth order is exogenous to all other variables. For
example, it naturally correlates with parental age, and it might also be
linked with the family's economic position at the time of birth. We only
claim that birth order is exogenous to genetic variation.

[^4]: Although genetic variation is randomly assigned to children at
    birth, genetics and birth order could be dependent if parents'
    choice of whether to have more children is endogenous to the genetic
    endowment of their earlier children. We check for this below.

Our main independent variable is respondents' birth order, i.e. their
number of elder siblings plus one. For controls we use family size, i.e.
their total number of siblings including themselves; month of birth; age
at interview; respondents' own PSEA; their father's and/or mother's age
at their birth (calculated from parent's current age, only available if
the parent was still alive). To test whether birth order effects are
mediated by SES, we use two measures: income, and university attendance.
Current income is a direct measure of SES, while university attendance
is a predictor of income over the entire life course.

-   TODO: Abdel - details of PSEA calculation and spouse pair inference
-   TODO: look at mechanisms by which birth order might affect
    university
-   TODO: get IQ data, control for it
-   TODO: overall index of social status?

Ideally, we might prefer to use birth order as an instrument for SES.
However, our measures of social status are noisy and incomplete. For
example, we know whether subjects went to university, but not which
university they went to, and we only have rough categorical data on
household income. Birth order likely affects both these measures, and
other, unmeasured dimensions of SES. So, an instrumental variables
approach would probably fall foul of the exclusion restriction.

Instead, we conduct a mediation analysis, following the strategy of
[@heckman2013understanding]. We first confirm statistically that birth
order affects our measures of respondents' SES (income and education).
Then, we regress spouse's PSEA on birth order, with and without
controlling for SES. Under the assumption that birth order is exogenous
to own genetics, these regressions identify the effect of birth order,
plus other environmental variables that correlate with it, on own social
status and spouse's genetics. Also, if the estimated effect of birth
order on spouse's PSEA changes when SES is controlled for, that is
evidence that SES mediates the effect of birth order.

-   TODO: Oana - clarify the empirical model including maintained
    assumptions
-   TODO: estimate individual income from job SIC codes? ASHE gives data
-   TODO: add year-of-birth dummies for cohort effects

# Results

```{r calc-bo-first-stage}

mod_bo_1st <- list()
mod_bo_1st$uni    <- lm(university ~ n_older_sibs + factor(n_sibs), famhist, 
                    subset = n_sibs >= 2 & n_sibs <= 8)
mod_bo_1st$income <- lm(income_cat ~ n_older_sibs + factor(n_sibs), famhist, 
                    subset = n_sibs >= 2 & n_sibs <= 8)

pval_bo_1st <- map(mod_bo_1st, 
                 ~tidy(.x) %>% filter(term == "n_older_sibs") %>% pull(p.value)
               )
pval_bo_1st %<>% map(format, digits = 3)
```

Figures \@ref(fig:pic-bo-uni) and \@ref(fig:pic-bo-income) show the
relationship between birth order, university education and income,
separately for respondents with 1-3 siblings. We test this formally in a
linear regression, controlling for family size, which may be correlated
with parental characteristics including genetics. Birth order is
negatively associated with both university attendance and income (among
respondents with 1-7 siblings: university $p$ = `r pval_bo_1st$uni`,
income $p$ = `r pval_bo_1st$income`).

```{r pic-bo-uni, fig.cap = "University attendance by birth order and family size", fig.height = 3}

famhist %>% 
      filter(n_sibs <= 4, n_sibs >= 2, ! is.na(n_older_sibs)) %>% 
      mutate(
        `Birth order` = n_older_sibs + 1,
        `Family size` = n_sibs
      ) %>% 
      group_by(`Birth order`, `Family size`) %>% 
      dplyr::summarize(University = mean(university, na.rm = TRUE), 
                       .groups = "drop_last") %>% 
      ggplot(aes(`Birth order`, University)) + 
        geom_col() +
        facet_grid(cols = vars(`Family size`), labeller = label_both) 

```

```{r pic-bo-income, fig.cap = "Income by birth order and family size", fig.height = 3}

famhist %>% 
      filter(
        n_sibs <= 4, 
        n_sibs >= 2, 
        ! is.na(n_older_sibs), 
        ! is.na(income_cat)
      ) %>% 
      mutate(
        `Birth order` = n_older_sibs + 1,
        `Family size` = n_sibs,
        `Income category` = factor(income_cat)
      ) %>% 
      ggplot(aes(`Birth order`, fill = `Income category`)) + 
      geom_bar(position = "fill") +
      facet_grid(cols = vars(`Family size`), labeller = label_both) + 
      scale_fill_brewer(palette = 2) + 
      labs(y = "Proportion")
```

Next we run regressions of spouse PSEA on birth order. Table
\@ref(tab:tbl-bo-psea-basic) reports the results. Subjects with 1-7
siblings are included. Column 1 controls only for family size (using
dummies). As expected, higher birth order is negatively associated with
spouse's PSEA, though the estimated effect size is small. Column 2
includes the respondent's own PSEA, as well as a quadratic in age, and
dummies for birth month to control for seasonality effects. The effect
size of birth order is not much changed.

Column 3 includes father's age at birth. Within a family, later children
have older parents by definition. Older parents have more life
experience and may have higher income, which would presumably help later
children. On the other hand, an early explanation for birth order
effects was that these could be due to genetic mutations in older
fathers, although more recent research has rejected this in favour of
"social" explanations [@kristensen2007explaining; @black2011older].[^5]
Including father's age means we can separate the effect of father's age
from birth order. This reduces the N by a lot, since only respondents
with live fathers reported the necessary data. However, the effect of
birth order jumps in size, to about half the effect of respondent's own
PSEA. Meanwhile, father's age has a positive effect. This suggests that
the previous estimates mixed two opposite-signed effects: having older
parents versus being later in birth order.[^6]

[^5]: [@cochran2013paternal] report that mutational load is
    approximately linear in father's age, while it is constant in
    mothers' age. We observe very similar results if we control for
    mother's age at respondent's birth.

[^6]: Note that parental age would not be a good independent variable
    for testing genetic encoding of social advantage, since it is likely
    to correlate with parents' genetics.

```{r tbl-bo-psea-basic}

fml_bo_psea_base <- list()

fml_bo_psea_base[[1]] <- EA3.y ~ n_older_sibs.x | factor(n_sibs.x)
fml_bo_psea_base[[2]] <- EA3.y ~ n_older_sibs.x + EA3.x + 
                            age_at_recruitment.x +
                            I(age_at_recruitment.x^2) + factor(birth_mon.x) |
                            factor(n_sibs.x)
  
fml_bo_psea_base[[3]] <- EA3.y ~ n_older_sibs.x + EA3.x + 
                            age_at_recruitment.x +
                            I(age_at_recruitment.x^2) + factor(birth_mon.x) +
                            fath_age_birth.x | factor(n_sibs.x)

fml_bo_psea_base <- lapply(fml_bo_psea_base, Formula::as.Formula)


mf_pairs_reg <- mf_pairs_twice %>% 
                  filter(
                    n_sibs.x >= 2, 
                    n_sibs.x <= 8, 
                    ! is.na(n_older_sibs.x)
                  )

mod_bo_psea_base <- lapply(fml_bo_psea_base, fixest::feols, 
                 data = mf_pairs_reg,
                 notes = FALSE
               )

huxreg(mod_bo_psea_base, 
        coefs = c(
          "Birth order"           = "n_older_sibs.x", 
          "Own PSEA"               = "EA3.x",
          "Father's age at birth" = "fath_age_birth.x"
        ),
         statistics = c(
           "N"           = "nobs", 
           "R2"          = "r.squared"
          ),
         note = "{stars}. Standard errors clustered by spouse pair. Respondents with 1-7 siblings included.",
         tidy_args = list(conf.int = FALSE, cluster = list(mf_pairs_reg$couple_id))
       ) %>% 
       insert_row(after = 7, "Family size dummies", rep("Yes", 3)) %>% 
       insert_row(after = 8, "Birth month dummies", "No", "Yes", "Yes") %>% 
       insert_row(after = 9, "Age quadratic", "No", "Yes", "Yes") %>% 
       set_bottom_border(8:9, everywhere, 0) %>% 
       set_number_format(2:7, -1, 4) %>% 
       set_width(0.8) %>% 
       set_caption("Regressions of spouse PSEA")


```

-   TODO: include age FTE as well as university - to check university
    has an "extra effect" - this slightly suggests that uni is a
    "marriage market" and not just granting extra skills

-   TODO: enquire about job history data - does it predict current
    profession well?

    -   otherwise we risk the critique that current profession is
        endogenous to spouse PSEA

-   TODO: consider alternative exogenous shocks to income. For example,
    some professions are more "cyclical" than others wrt recessions. If
    we could do predicted income at age 21-25 from business cycle X
    profession, that might count as exogenous. (Could use an independent
    source to estimate evolution of incomes, e.g. GHS or BHPS)

-   TODO: get IQ data from Abdel - again this controls for skills

-   TODO: get 2178 "overall health" and 2188 "longstanding
    illness/disability/infirmity"

    -   control for effect on health

-   Overall idea here is to unpack the different effects of birth order,
    separate them from university/income.

Having tested that birth order affects spouse's PSEA, we now look for
potential mediators of this effect. Despite the lower N, we continue to
control for respondents' fathers' age, since this removes a confound
which would bias our results towards zero.[^7]

[^7]: The appendix reports results without controlling for father's age.

```{r tbl-bo-psea}


fml_bo_psea <- list()

fml_bo_psea[[1]] <- EA3.y ~ n_older_sibs.x | factor(n_sibs.x)
fml_bo_psea[[2]] <- EA3.y ~ university.x + n_older_sibs.x | factor(n_sibs.x)
fml_bo_psea[[3]] <- EA3.y ~ income_cat.x + n_older_sibs.x | factor(n_sibs.x)
fml_bo_psea[[4]] <- EA3.y ~ income_cat.x + university.x + n_older_sibs.x |
      factor(n_sibs.x)

fml_bo_psea <- lapply(fml_bo_psea, Formula::as.Formula)

# common controls
fml_bo_psea <- lapply(fml_bo_psea, update, 
                        . ~ . + EA3.x + age_at_recruitment.x + 
                          fath_age_birth.x +
                          I(age_at_recruitment.x^2) + factor(birth_mon.x), 
                        rhs = 1
                      )

mf_pairs_reg <- mf_pairs_twice %>% 
                  filter(
                    n_sibs.x >= 2, 
                    n_sibs.x <= 8, 
                    ! is.na(n_older_sibs.x),
                    ! is.na(university.x),
                    ! is.na(income_cat.x),
                    ! is.na(fath_age_birth.x)
                  )

mod_bo_psea <- lapply(fml_bo_psea, fixest::feols, 
                 data = mf_pairs_reg,
                 notes = FALSE
               )

huxreg(mod_bo_psea, 
        coefs = c(
          "Birth order"           = "n_older_sibs.x", 
          "University"            = "university.xTRUE", 
          "Income"                = "income_cat.x",
          "Own PSEA"              = "EA3.x",
          "Father's age at birth" = "fath_age_birth.x"
        ),
         note = "{stars}. Standard errors clustered by spouse pair.",
         tidy_args = list(conf.int = FALSE, cluster = list(mf_pairs_reg$couple_id))
       ) %>% 
       insert_row(after = 11, "Family size dummies", rep("Yes", 4)) %>% 
       insert_row(after = 12, "Birth month dummies", rep("Yes", 4)) %>% 
       insert_row(after = 13, "Age quadratic", rep("Yes", 4)) %>% 
       set_bottom_border(12:13, everywhere, 0) %>% 
       set_number_format(2:11, -1, 4) %>% 
       set_caption("Regressions of spouse PSEA")
```

```{r calc-bootstrap-proportions, cache = TRUE}

# to rerun this, just add a space below. Don't set cache = FALSE!
n_boot <- 199

bo_prop_boot <- replicate(n_boot, {
  mf_pairs_resample <- mf_pairs_reg %>% sample_frac(1, replace = TRUE)
  tmp  <- fixest::feols(fml_bo_psea[[1]], data = mf_pairs_resample, notes = FALSE)
  tmp2 <- fixest::feols(fml_bo_psea[[2]], data = mf_pairs_resample, notes = FALSE)
  tmp3 <- fixest::feols(fml_bo_psea[[3]], data = mf_pairs_resample, notes = FALSE)
  tmp4 <- fixest::feols(fml_bo_psea[[4]], data = mf_pairs_resample, notes = FALSE)
  orig_coef <- coef(tmp)["n_older_sibs.x"]
  c(
    prop_uni  = coef(tmp2)["n_older_sibs.x"]/orig_coef,
    prop_inc  = coef(tmp3)["n_older_sibs.x"]/orig_coef,
    prop_both = coef(tmp4)["n_older_sibs.x"]/orig_coef
  )
})
```

```{r clean-bootstrap-proportions}
bo_prop_ci <- apply(bo_prop_boot, 1, quantile, probs = c(.975, .025))
# the percentage reduction:
bo_prop_ci[] <- sprintf("%.1f%%", (1 - bo_prop_ci) * 100)

# point estimates from main regressions:
orig_coef <- coef(mod_bo_psea[[1]])["n_older_sibs.x"]
bo_prop_est <- apply(bo_prop_boot, 1, mean)
bo_prop_est  <- sprintf("%.1f%%", (1 - bo_prop_est) * 100)

```

Table \@ref(tab:tbl-bo-psea) shows the results. Column 1 shows the
effect of birth order, using the same specification as column 3 of the
previous table. (We exclude respondents without data on income or
university attendance, to make comparison easier across the columns:
this reduces the N slightly.) The remaining columns control for our SES
variables, which are potential mediators of birth order effects. Column
2 includes university attendance. Column 3 includes income. Column 4
includes both. We estimate the percentage decrease in the effect of
birth order across the columns, along with 95% confidence intervals for
this figure, by running bootstraps (N = `r n_boot`).[^8] Including
university attendance alone reduces the effect of birth order by
`r bo_prop_est[1]` (CI `r bo_prop_ci[1, 1]` -- `r bo_prop_ci[2, 1]`).
Including income alone reduces the effect of birth order by
`r bo_prop_est[2]` (CI `r bo_prop_ci[1, 2]` -- `r bo_prop_ci[2, 2]`).
Including both decreases the effect by `r bo_prop_est[3]` (CI
`r bo_prop_ci[1, 3]` -- `r bo_prop_ci[2, 3]`).

[^8]: The sample percentage decrease calculated from the figures in
    Table \@ref(tab:tbl-bo-psea) is not the correct estimator, since
    $E(X/Y)$ is not equal to $EX/EY$.

Our next regressions split up the data into subsets. Cultural
stereotypes often assume that the link between status and genes is not
symmetric across the genders, for example, that males with high SES are
particularly likely to marry attractive spouses. To test this, we
separately regress female spouses' PSEA on male birth order, and male
spouses' PSEA on female birth order. We also rerun regressions among the
subset of individuals who had children. A significant result here will
confirm that the association between status and genetics is carried over
into the next generation.

Table \@ref(tab:tbl-bo-subsets) shows the results.

-   TODO: describe results

-   TODO: very few couple pairs (\< 50%) report the same number of
    children. Why?

    -   equally likely to be males or females reporting more.

```{r tbl-bo-subsets}

mod_bo_males <- lapply(fml_bo_psea[1:2], fixest::feols, 
                 data = mf_pairs_reg %>% filter(x == "Male"),
                 notes = FALSE
               )
mod_bo_females <- lapply(fml_bo_psea[1:2], fixest::feols, 
                 data = mf_pairs_reg %>% filter(x == "Female"),
                 notes = FALSE
               )

mf_pairs_children <- mf_pairs_reg %>% 
                   filter(n_children.x > 0, n_children.y > 0)
mod_bo_children <- lapply(fml_bo_psea[1:2], fixest::feols, 
                 data = mf_pairs_children,
                 notes = FALSE
               )

ta <-  list(conf.int = FALSE, cluster = list(mf_pairs_children$couple_id))

reg_list <- list(
        `Females` = mod_bo_males[[1]],
        `Females` = mod_bo_males[[2]],
        `Males`   = mod_bo_females[[1]],
        `Males`   = mod_bo_females[[2]],
        `With children` = mod_bo_children[[1]],
        `With children` = mod_bo_children[[2]]
      )

huxreg(reg_list,
       coefs = c(
          "Birth order"           = "n_older_sibs.x", 
          "University"            = "university.xTRUE", 
          "Father's age at birth" = "fath_age_birth.x",
          "Own PSEA"              = "EA3.x"
        ),
         note = "{stars}. Standard errors for columns 5 and 6 clustered by spouse pair.",
          tidy_args = list(list(), list(), list(), list(), ta, ta)
       ) %>% 
       # insert_row(after = 9, "Family size dummies", rep("Yes", 4)) %>% 
       # set_number_format(2:9, -1, 4) %>% 
       set_caption("Regressions of spouse PSEA: subsets")
```

## Robustness

```{r tbl-pgs-check}

check_cor <- function (score_name) {
  fml_check <- as.formula(paste(score_name, "~ factor(n_sibs) + n_older_sibs"))
  mod_check <- lm(fml_check, famhist, n_sibs >= 2 & n_sibs <= 8)
  mod_check %>% 
        tidy() %>% 
        filter(term == "n_older_sibs") %>% 
        mutate(score = score_name)
}

drake::loadd(score_names)
score_names <- paste0(score_names, "_resid")
check_result <- purrr::map_dfr(score_names, check_cor)

if (any(check_result$p.value < 0.1/33)) stop("Some check p values < 0.1/33; rewrite text!")

n_10 <- sum(check_result$p.value < 0.1)
if (n_10 != 3) stop("Different number of PGS had p < 0.10; rewrite text!")

max_coef <- max(abs(check_result$estimate))
```

Although all children of the same parents have the same polygenic scores
in expectation, it could still be possible that genetics correlates with
birth order within the sample. This could happen in three ways.

First, siblings with high birth order will typically come from larger
families than those with low birth order, and parents of different-sized
families are likely to differ systematically on many dimensions,
including genetics. We controlled for this by including a full set of
family size dummies in the regression.[^9]

[^9]: Table \@ref(tab:tbl-bo-psea-interactions) in the appendix
    estimates a separate birth order coefficient within each family
    size.

Second, there could be ascertainment bias. For example, if later
siblings with high PSEA, and earlier siblings with low PSEA, are more
likely to enter the sample, then this would bias our results.

Thirdly, parents might select family size on the basis of genetics. For
example, suppose that if the first child had a phenotype reflecting a
high PSEA, parents are more likely to have a second child. Then within
the subset of two-child families, first children would have
higher-than-average PSEA while second children would not.

- TODO: repeat balance tests within family sizes.

We check this by regressing 33 different polygenic scores on birth
order, controlling for family size.[^10] No scores were significant at
$p < 0.10/33$. `r n_10` scores were significant at $p < 0.10$ (body mass
index, conscientousness, and neuroticism). Coefficients were never
greater than 0.01 of a standard deviation. Table
\@ref(tab:tbl-bo-psea-robust) in the appendix reruns regressions
controlling for these scores. Results are almost unchanged.

[^10]: Polygenic scores were residualized on the first principal
    components of the genetic data. Scores were for: ADHD, age at
    menarche, age at menopause, agreeableness, age at smoking
    initiation, alcohol use, Alzheimer's, autism, bipolarity, BMI, body
    fat, caffeine consumption, cannabis (ever vs. never), cognitive
    ability, conscientiousness, coronary artery disease, smoking
    (cigarettes per day), type II diabetes, drinks per week, educational
    attainment (EA2 and EA3), anorexia, extraversion, height, hip
    circumference, major depressive disorder, neuroticism, openness,
    smoking cessation, schizophrenia, smoking initiation, waist
    circumference, and waist-to-hip ratio.

# Conclusion

Behaviour geneticists have pointed out that in meritocratic societies,
genetics and social status will be correlated, because some genetic
variants will lead to success in the labour market. We argue that
causality can also go the other way. If social status and genetics both
matter in marriage markets, then people with high social status will
attract partners with "good genes", and the two will become associated
in the next generation.

Our empirical analysis shows that in a modern Western democracy,
earlier-born children had spouses with higher PSEA. Thus, an
environmental shock has effects on the genetics of people's spouses and
becomes encoded in the genetics of their children. We also provided
evidence that these effects are mediated by social status: income and
education.

Social scientists have tended to assume that social status is unrelated
to "natural" differences between individuals, including genetic
differences. This view dates back at least to [@hobbes1651leviathan]. By
contrast, it has been widely believed in many societies that innate
traits do vary across social classes. The ancient Greeks described the
social elite as *kaloi kagathoi* ("fine and good"), while the Roman
nobility were the *optimates* ("best").[^11] This belief has been
explained by the human tendency to believe in a just world
[@furnham1993just], or as an ideology promoted by the dominant class
[e.g. @gramsci1971selections]. However, it may also simply have been a
recognition of (social) reality. In other words,\
the belief that elites are taller, stronger, better-looking, etc. is not
much different from the belief that elites are richer and more powerful,
and is likely to be held for fairly similar reasons. The belief that
human traits are inherited across generations is probably quite
widespread across different cultures [@moya2015reasoning]: this, plus
the observation that status matters in marriage markets, provides a
cognitive basis for reasoning to the conclusion of class differences.
Alternatively, the belief might simply come from empirical observation.

[^11]: The appendix contains a selection of relevant historical
    quotations.

In our model, the association between social status and genetic
variation depends on the structure of the society's marriage market. The
association is weaker when marriage markets are very socially
egalitarian, with marriage pairing driven only by genetics, or very
inegalitarian, with pairings driven only by status. This logic is
different from the standard reason for association between genes and
SES. There, more meritocratic societies allow a greater role for genetic
variants linked to labour market success. Thus, there is a monotonic
relationship: more meritocracy leads to a stronger gene-environment
correlation (rGE) between genetics and SES. Here, the relationship is
non-monotonic: rGE is strongest at intermediate levels of "meritocracy"
in marriage markets. Comparing rGE across societies or over time is
beyond our scope here, but we see it as a good area for future work.
Marriage markets may play an important role in explaining how social
inequality varies across different societies. More broadly, the
correlation between genetics and social status does not undermine our
concern with social inequality; rather, since it is a social outcome, it
is itself one dimension of social inequality. Genes, like other kinds of
resource, are distributed unequally by social systems.

Over history, the marriage market mechanism has probably operated in a
much greater variety of societies than the labour market mechanism,
because societies in which status can be earned are relatively rare
compared to those in which status is inherited. (TODO: cite WEIRD? Or
"status vs contract"?) As a result, we would predict long-standing
correlations between social status and causal genetic variants. This
prediction could be tested on ancient DNA data.

Our analysis also has implications for the practice of controlling
polygenic scores by partialling out principal components of genetic
data. This is done so as to avoid confounding the effects of genetic
variation with social stratification. However, insofar as the
geneticists' concept of stratification (mating which is non-random with
respect to genetics) overlaps with the sociological concept of
stratification (a hierarchical ranking of social status), stratification
will predictably associate with causally relevant genetic variants. For
this reason, we would expect principal components to contain real
information about causally relevant variants. So, it is an empirical
question whether controlling for principal components improves or
weakens the predictive power of polygenic scores. Within-family analyses
could resolve this question.

In popular media, and sometimes by social scientists, genetics are often
thought of as an external, "natural" constraint on social structure.
This is one reason why behaviour genetics remains a controversial topic.
The broadest message of our research is that individual genetics are a
social outcome like any other. They can even be viewed as another form
of capital, alongside human, social and cultural capital: a resource to
be sought, accumulated and competed over. The analysis of this kind of
capital is an exciting area for further research, which collaborating
teams of social scientists and geneticists will be well-placed to
exploit.

\FloatBarrier

\newpage

# Appendix

## Second part of Proposition \@ref(prop:prop1)

```{=tex}
\begin{proof}
Write

\begin{equation}
corr(G_{j},S_{j})=\frac{cov(G_{j},S_{j})}{\sqrt{var(G_{j})var(S_{j})}}\textrm{ for both generations }j\in\{p,c\}.\label{eq:corr-cov-var}
\end{equation}

where 

\begin{align*}
var(G_{p}) & =\frac{1}{2}\int g_{d}^{2}+g_{p(d)}^{2}\textrm{d}d;\\
var(G_{c}) & =\int g_{c(d)}^{2}\textrm{d}d.
\end{align*}

Much as before,
\begin{align*}
g_{d}^{2}+g_{m}^{2} & =(g_{c}-\Delta g)^{2}+(g_{c}+\Delta g)^{2}\\
 & =2g_{c}^{2}+2(\Delta g)^{2}\\
 & \ge2g_{c}^{2}.
\end{align*}

This shows that $var(G_{c})\le var(G_{p})$ and a similar argument
shows $var(S_{c})\le var(S_{p})$. Thus the covariance is higher (and
positive) in the children's generation, while the variances are lower.
Combining these ensures that 

\[
corr(G_{c},S_{c}) \ge corr(G_{p},S_{p}).
\]

Since for any $k$, either $var(G_{c}) < var(G_{p})$ or $var(S_{c}) < var(S_{p})$,
the only way to get strict equality for the above is if $k \in \{0,1\}$
and $cov(G_{c}, S_{c}) = cov(G_{p},S_{p}) = 0$.

\end{proof}
```
To show that the condition in the second part cannot be relaxed further,
consider the distribution in Figure
\ref{fig:Correlation-counterexample}. There is negative correlation in
the parents' generation (the shaded area). If $k = 1$ or is close enough
to 1, then assortative mating along the dotted lines will reduce the
variance of $S$ along those lines, pushing the distribution towards the
darker central area, without affecting the covariance. This will make
the correlation more negative. After repeated generations the horizontal
variance within values of $G$ will almost disappear and the correlation
will approach -1.

```{=tex}
\begin{figure}
\begin{centering}
\includegraphics[width=0.5\columnwidth]{correlation-counterexample}
\par\end{centering}
\caption{Correlation counterexample\label{fig:Correlation-counterexample}}

\end{figure}
```
## Proposition \ref{prop:robustness}

```{=tex}
\begin{proof}

Note that in proposition \ref{prop:prop1}, we took $g_{c(i)} = \bar{g}_{i}$ and $s_{c(i)} = \bar{s}_i$. Write 

\begin{align}
cov(G_{c},S_{c}) & =cov(\bar{G}+\varepsilon^{G},\bar{S}+\varepsilon^{S})\nonumber \\
 & = cov(\bar{G},\bar{S}) + cov(\varepsilon^{G},\bar{S}) + 
     cov(\bar{G},\varepsilon^{S}) + cov(\varepsilon^{G},\varepsilon^{S}).
 \label{eq:cov-with-error}
\end{align}

For any $X$ and $Y$, $cov(X, Y)$ is bounded by $\sqrt{var(X) var(Y)}$.
Plugging $\sigma_{G}^{2}$ and $\sigma_{S}^{2}$ into this formula
shows that under condition 1, $cov(G_{c},S_{c})$ will be arbitrarily
close to $cov(\bar{G},\bar{S})$. Similarly, writing

\[
var(G_{c}) = var(\bar{G}) + var(\varepsilon^{G}) + 2cov(\bar{G},\varepsilon^{G})
\]

shows that $var(G_{c})$ will approach $var(\bar{G})$ as $\sigma_{G}^{2}$
grows small, and similarly for $var(S_{c})$. Plugging these facts
into (\ref{eq:corr-cov-var}) shows that $corr(G_{c},S_{c})$ approaches
$corr(\bar{G},\bar{S})$ as $\sigma_{G}^{2}$ and $\sigma_{S}^{2}$
grow small. Proposition 1 then shows $corr(\bar{G},\bar{S}) < corr(G_{p},S_{p})$
for $k\in(0,1)$.

Under condition 2, $cov(G_{c}, S_{c}) = cov(\bar{G},\bar{S})$ since
the last three terms of the sum in (\ref{eq:cov-with-error}) are
zero. Then since 
\[
cov(\bar{G},\bar{S})\ge cov(G_{p},S_{p}) = 0
\]
with strict inequality iff $k\in(0,1)$, the covariance signs the
correlation. 

\end{proof}
```
\FloatBarrier

\newpage

## Robustness checks

```{r tbl-bo-no-fath-age}


age_table <- famhist %>% 
      filter(n_sibs >=2, n_sibs <= 8, ! is.na(n_older_sibs)) %>% 
      group_by(n_sibs, n_older_sibs) %>% 
      dplyr::summarize(
        N   = n(), 
        mfa = mean(fath_age_birth, na.rm = TRUE),
        mma = mean(moth_age_birth, na.rm = TRUE),
        .groups = "drop"
      )

mf_pairs_reg_big <- mf_pairs_twice %>% 
                  filter(
                    n_sibs.x >= 2, 
                    n_sibs.x <= 8, 
                    ! is.na(n_older_sibs.x),
                    ! is.na(university.x),
                    ! is.na(income_cat.x)
                  )

fml_bo_no_fath_age <- lapply(fml_bo_psea, update, 
                     . ~ . - fath_age_birth.x, 
                     rhs = 1
                   )
mod_bo_no_fath_age <- lapply(fml_bo_no_fath_age, fixest::feols,
                     data  = mf_pairs_reg_big, 
                     notes = FALSE
                   )

fml_bo_moth_age <- lapply(fml_bo_no_fath_age, update, 
                     . ~ . + moth_age_birth.x, 
                     rhs = 1
                   )
mod_bo_moth_age <- lapply(fml_bo_moth_age, fixest::feols,
                     data  = mf_pairs_reg_big, 
                     notes = FALSE
                   )

huxreg(mod_bo_no_fath_age, 
        coefs = c(
          "Birth order"           = "n_older_sibs.x", 
          "University"            = "university.xTRUE", 
          "Income"                = "income_cat.x", 
          "Own EA3"               = "EA3.x"
        ),
         note = "{stars}. Standard errors clustered by spouse pair.",
         tidy_args = list(conf.int = FALSE, cluster = list(mf_pairs_reg_big$couple_id))
       ) %>% 
       insert_row(after = 9, "Family size dummies", rep("Yes", 4)) %>% 
       insert_row(after = 10, "Birth month dummies", rep("Yes", 4)) %>% 
       insert_row(after = 11, "Age quadratic", rep("Yes", 4)) %>% 
       set_bottom_border(10:11, everywhere, 0) %>% 
       set_number_format(2:9, -1, 4) %>% 
       set_caption("Regressions of spouse PSEA, without controls for father's age at respondent's birth")

```

```{r tbl-bo-psea-interactions}

fml_bo_psea_ix <- fml_bo_psea %>% 
                    purrr::map(update, 
                               . ~ . - n_older_sibs.x + n_older_sibs.x:factor(n_sibs.x),
                                 rhs = 1 
                               )

mod_bo_psea_ix <-  purrr::map(fml_bo_psea_ix, fixest::feols, 
                         data = mf_pairs_reg,
                         notes = FALSE
                       )


huxreg_coefs <- grep(":", names(coef(mod_bo_psea_ix[[1]])), value = TRUE)
names(huxreg_coefs) <- gsub(".*(\\d)$", "Birth order X family size \\1",
                            huxreg_coefs)
huxreg_coefs <- c(
                   huxreg_coefs,
                   "University"  = "university.xTRUE", 
                   "Income"      = "income_cat.x", 
                   "Own EA3"     = "EA3.x"
                 )

huxtable::huxreg(mod_bo_psea_ix, 
                   coefs = huxreg_coefs,
                   note = "{stars}. Standard errors clustered by spouse pair.",
                   tidy_args = list(
                     conf.int = FALSE, 
                     cluster = list(mf_pairs_reg$couple_id)
                   )
                 ) %>% 
       insert_row(after = 21, "Family size dummies", rep("Yes", 4)) %>% 
       insert_row(after = 22, "Birth month dummies", rep("Yes", 4)) %>% 
       insert_row(after = 23, "Age quadratic", rep("Yes", 4)) %>% 
       set_bottom_border(22:23, everywhere, 0) %>% 
       set_number_format(2:21, -1, 4) %>% 
       set_caption("Regressions of spouse PSEA, separate birth order coefficients for each family size") %>% 
       set_font_size(10)

```

```{r tbl-bo-psea-robust}

fml_bo_psea_robust <- fml_bo_psea %>% 
                        purrr::map(update, 
                           . ~ . + 
                           bmi_combined_resid.x + 
                           conscientiousness_resid.x + 
                           neuroticism_resid.x
                        )

mod_bo_psea_robust <-  purrr::map(fml_bo_psea_robust, fixest::feols, 
                         data = mf_pairs_reg,
                         notes = FALSE
                       )

huxreg(mod_bo_psea_robust, 
         coefs = c(
           "Birth order"           = "n_older_sibs.x", 
           "University"            = "university.xTRUE", 
           "Income"                = "income_cat.x",
           "Father's age at birth" = "fath_age_birth.x",
           "Own PSEA"              = "EA3.x"
         ),
         statistics = c(
           "N" = "nobs", 
           "R2" = "r.squared"
         ),
         note = "{stars}. Standard errors clustered by spouse pair.",
         tidy_args = list(conf.int = FALSE, cluster = mf_pairs_reg$couple_id)
       ) %>% 
       insert_row(after = 11, "Family size dummies", rep("Yes", 4)) %>% 
       insert_row(after = 12, "Birth month dummies", rep("Yes", 4)) %>% 
       insert_row(after = 13, "Age quadratic", rep("Yes", 4)) %>% 
       insert_row(after = 14, "Polygenic score controls", rep("Yes", 4)) %>% 
       set_top_border(13:15, everywhere, 0) %>% 
       set_number_format(2:11, -1, 4) %>% 
       set_caption("Regressions of spouse PSEA with controls for polygenic scores")
```

\FloatBarrier

\newpage

## Quotations on natural inequality

...your face and figure have nothing of the slave about them, and
proclaim you of noble birth.

-- *Odyssey*, Odysseus to Laertes

Citizens, we shall say to them in our tale, you are brothers, yet God
has framed you differently. Some of you have the power of command, and
in the composition of these he has mingled gold, wherefore also they
have the greatest honour; others he has made of silver, to be
auxiliaries; others again who are to be husbandmen and craftsmen he has
composed of brass and iron; and the species will generally be preserved
in the children. But as all are of the same original stock, a golden
parent will sometimes have a silver son, or a silver parent a golden
son.

-- Plato *Republic*

Nature would like to distinguish between the bodies of freemen and
slaves, making the one strong for servile labor, the other upright, and
although useless for such services, useful for political life in the
arts both of war and peace. But the opposite often happens -- that some
have the souls and others have the bodies of freemen.

-- Aristotle *Politics*

Sons have no richer endowment than the quality

A noble and brave father gives in their begetting.

-- Euripides *Heracleidae*

His looks are full of peaceful majesty,

His head by nature fram'd to wear a crown,

His hands to wield a sceptre....

-- Shakespeare *Henry VI Part 3*

A daughter of a green Grocer, walks the Streets in London dayly with a
baskett of Cabbage Sprouts, Dandelions and Spinage on her head. She is
observed by the Painters to have a beautiful Face, an elegant figure, a
graceful Step and a debonair. They hire her to Sitt. She complies, and
is painted by forty Artists, in a Circle around her. The Scientific Sir
William Hamilton outbids the Painters, Sends her to Schools for a
genteel Education and Marries her. This Lady not only causes the
Tryumphs of the Nile of Copenhagen and Trafalgar, but Seperates Naples
from France and finally banishes the King and Queen from Sicilly. Such
is the Aristocracy of the natural Talent of Beauty.

-- John Adams to Thomas Jefferson, on Emma Hamilton

\newpage

# References
